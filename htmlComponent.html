<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    
    <!-- SEO Meta Tags -->
    <meta name="description" content="Gil Sorvetes - 25 anos oferecendo os melhores sorvetes, picol√©s e gelatos. Qualidade, tradi√ß√£o e sabor que conquistam toda fam√≠lia.">
    <meta name="keywords" content="sorvetes, picol√©s, gelatos, Gil Sorvetes, sorveteria, sobremesas geladas, a√ßa√≠, sorvete artesanal">
    <meta name="author" content="Gil Sorvetes">
    <meta name="robots" content="index, follow">
    
    <!-- Open Graph Meta Tags -->
    <meta property="og:title" content="Gil Sorvetes - 25 Anos de Tradi√ß√£o">
    <meta property="og:description" content="Os melhores sorvetes, picol√©s e gelatos da regi√£o. Qualidade e sabor que conquistam toda fam√≠lia h√° 25 anos.">
    <meta property="og:image" content="./assets/logo/logo.jpg">
    <meta property="og:url" content="">
    <meta property="og:type" content="website">
    <meta property="og:locale" content="pt_BR">
    
    <!-- Twitter Card Meta Tags -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Gil Sorvetes - 25 Anos de Tradi√ß√£o">
    <meta name="twitter:description" content="Os melhores sorvetes, picol√©s e gelatos da regi√£o. Qualidade e sabor que conquistam toda fam√≠lia.">
    <meta name="twitter:image" content="./assets/logo/logo.jpg">
    
    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="./assets/logo/logo.jpg">
    <link rel="apple-touch-icon" href="./assets/logo/logo.jpg">
    
    <!-- Preload Critical Resources -->
    <link rel="preload" href="./style/style.css" as="style">
    <link rel="preload" href="./assets/logo/logo.jpg" as="image">
    
    <!-- CSS -->
    <link rel="stylesheet" href="./style/style.css">
    
    <!-- DNS Prefetch for External Resources -->
    <link rel="dns-prefetch" href="//wa.me">
    <link rel="dns-prefetch" href="//api.whatsapp.com">
    
    <title>Gil Sorvetes - 25 Anos de Tradi√ß√£o</title>
    
    <!-- Performance and Analytics -->
    <script>
        // Lazy loading polyfill for older browsers
        if ('loading' in HTMLImageElement.prototype === false) {
            const script = document.createElement('script');
            script.src = 'https://polyfill.io/v3/polyfill.min.js?features=IntersectionObserver';
            document.head.appendChild(script);
        }
    </script>
</head>
<body>

<!-- Header Component - Gil Sorvetes -->
<header class="main-header">
    <div class="header-container">
        <div class="logo-section">
            <a href="index.html" class="logo-link" aria-label="Gil Sorvetes - P√°gina Inicial">
                <img src="./assets/logo/logo.jpg" alt="Gil Sorvetes - 25 anos de tradi√ß√£o" class="logo-img">
            </a>
        </div>

        <div class="search-section">
            <form class="search-form" role="search" aria-label="Buscar produtos">
                <div class="search-input-wrapper">
                    <label for="searchInput" class="sr-only">Buscar produtos</label>
                    <input 
                        type="search" 
                        id="searchInput" 
                        name="search"
                        placeholder="Buscar sorvetes, picol√©s..." 
                        aria-label="Campo de busca de produtos"
                        aria-describedby="search-help"
                        autocomplete="off"
                        spellcheck="false"
                        maxlength="100"
                    />
                    <button type="button" class="search-clear" aria-label="Limpar campo de busca" style="display: none;">
                        <span aria-hidden="true">√ó</span>
                    </button>
                    <div id="search-help" class="sr-only">Digite para buscar produtos em tempo real</div>
                </div>
                <button type="submit" class="search-submit" aria-label="Executar busca">
                    <span aria-hidden="true">üîç</span>
                </button>
            </form>
        </div>

        <div class="cart-section">
            <a href="carrinho.html" class="cart-link" aria-label="Ver carrinho de compras">
                <div class="cart-icon-wrapper">
                    <img src="./assets/icon/icon-cart-empty.svg" alt="" class="cart-icon" aria-hidden="true">
                    <span class="cart-counter" id="cartCounter" aria-label="Itens no carrinho">0</span>
                </div>
                <span class="cart-text">Carrinho</span>
            </a>
        </div>

        <!-- Menu mobile toggle -->
        <button class="mobile-menu-toggle" aria-label="Abrir menu de navega√ß√£o" aria-expanded="false" aria-controls="mainNav">
            <span aria-hidden="true"></span>
            <span aria-hidden="true"></span>
            <span aria-hidden="true"></span>
        </button>
    </div>
</header>

<nav class="main-nav" id="mainNav">
    <div class="nav-container">
        <ul class="nav-menu" role="menubar">
            <li class="nav-item" role="none">
                <a href="index.html" class="nav-link" role="menuitem" data-page="home">
                    <span class="nav-icon">üè†</span>
                    <span class="nav-text">Home</span>
                </a>
            </li>
            <li class="nav-item" role="none">
                <a href="catalogo.html" class="nav-link" role="menuitem" data-page="catalogo">
                    <span class="nav-icon">üìã</span>
                    <span class="nav-text">Cat√°logo</span>
                </a>
            </li>
            <li class="nav-item" role="none">
                <a href="sobre.html" class="nav-link" role="menuitem" data-page="sobre">
                    <span class="nav-icon">‚ÑπÔ∏è</span>
                    <span class="nav-text">Sobre</span>
                </a>
            </li>
            <li class="nav-item" role="none">
                <a href="contato.html" class="nav-link" role="menuitem" data-page="contato">
                    <span class="nav-icon">üìû</span>
                    <span class="nav-text">Contato</span>
                </a>
            </li>
        </ul>

        <!-- Links r√°pidos para mobile -->
        <div class="nav-quick-links">
            <a href="https://wa.me/5511999999999" class="quick-link whatsapp" target="_blank" rel="noopener noreferrer" aria-label="Entrar em contato via WhatsApp">
                <span aria-hidden="true">üí¨</span> WhatsApp
            </a>
            <a href="tel:+5511999999999" class="quick-link phone" aria-label="Ligar para Gil Sorvetes">
                <span aria-hidden="true">üìû</span> Ligar
            </a>
        </div>

        <!-- Informa√ß√µes adicionais para acessibilidade -->
        <div class="nav-info sr-only">
            <p>Use as setas do teclado para navegar pelo menu. Pressione Escape para fechar.</p>
        </div>
    </div>
</nav>

<script>
// Header Component Enhanced Script
document.addEventListener('DOMContentLoaded', function() {
    // Performance optimization - debounce function
    function debounce(func, wait) {
        let timeout;
        return function executedFunction(...args) {
            const later = () => {
                clearTimeout(timeout);
                func(...args);
            };
            clearTimeout(timeout);
            timeout = setTimeout(later, wait);
        };
    }
    
    // Menu mobile toggle
    const mobileToggle = document.querySelector('.mobile-menu-toggle');
    const mainNav = document.getElementById('mainNav');
    const body = document.body;
    
    if (mobileToggle && mainNav) {
        mobileToggle.addEventListener('click', function() {
            const isExpanded = this.getAttribute('aria-expanded') === 'true';
            this.setAttribute('aria-expanded', !isExpanded);
            mainNav.classList.toggle('nav-open');
            body.classList.toggle('nav-open');
            
            // Prevent scroll when menu is open
            if (mainNav.classList.contains('nav-open')) {
                body.style.overflow = 'hidden';
            } else {
                body.style.overflow = '';
            }
        });
    }
    
    // Destacar p√°gina atual com melhor detec√ß√£o
    const currentPage = window.location.pathname.split('/').pop() || 'index.html';
    const navLinks = document.querySelectorAll('.nav-link[data-page]');
    
    navLinks.forEach(link => {
        const linkPage = link.getAttribute('data-page');
        if ((currentPage === 'index.html' && linkPage === 'home') ||
            (currentPage === '' && linkPage === 'home') ||
            currentPage.includes(linkPage)) {
            link.classList.add('active');
            link.setAttribute('aria-current', 'page');
        }
    });
    
    // Funcionalidade da busca com melhorias
    const searchInput = document.getElementById('searchInput');
    const searchClear = document.querySelector('.search-clear');
    
    if (searchInput && searchClear) {
        // Debounced search to improve performance
        const debouncedSearch = debounce(function() {
            // Trigger search functionality from main.js if available
            if (window.handleSearch) {
                window.handleSearch(searchInput.value);
            }
        }, 300);
        
        searchInput.addEventListener('input', function() {
            const value = this.value.trim();
            
            if (value.length > 0) {
                searchClear.style.display = 'block';
                debouncedSearch();
            } else {
                searchClear.style.display = 'none';
                // Clear search results
                if (window.handleSearch) {
                    window.handleSearch('');
                }
            }
        });
        
        searchClear.addEventListener('click', function() {
            searchInput.value = '';
            searchInput.focus();
            this.style.display = 'none';
            
            // Clear search results
            if (window.handleSearch) {
                window.handleSearch('');
            }
        });
        
        // Handle Enter key
        searchInput.addEventListener('keydown', function(e) {
            if (e.key === 'Enter') {
                e.preventDefault();
                debouncedSearch();
            }
        });
    }
    
    // Fechar menu ao clicar em link (mobile)
    navLinks.forEach(link => {
        link.addEventListener('click', function() {
            if (mainNav && mainNav.classList.contains('nav-open')) {
                mobileToggle.click();
            }
        });
    });
    
    // Fechar menu ao clicar fora (mobile) com melhor performance
    let clickOutsideHandler = null;
    
    function handleClickOutside(e) {
        if (!mainNav.contains(e.target) && !mobileToggle.contains(e.target)) {
            if (mainNav.classList.contains('nav-open')) {
                mobileToggle.click();
            }
        }
    }
    
    // Only add click outside listener when menu is open
    if (mobileToggle) {
        mobileToggle.addEventListener('click', function() {
            setTimeout(() => {
                if (mainNav.classList.contains('nav-open')) {
                    document.addEventListener('click', handleClickOutside);
                } else {
                    document.removeEventListener('click', handleClickOutside);
                }
            }, 100);
        });
    }
    
    // Handle escape key to close menu
    document.addEventListener('keydown', function(e) {
        if (e.key === 'Escape' && mainNav && mainNav.classList.contains('nav-open')) {
            mobileToggle.click();
        }
    });
    
    // Cart counter update functionality
    function updateCartCounter() {
        const cartCounter = document.getElementById('cartCounter');
        if (cartCounter && window.getCartItemCount) {
            const count = window.getCartItemCount();
            cartCounter.textContent = count;
            cartCounter.style.display = count > 0 ? 'flex' : 'none';
        }
    }
    
    // Listen for cart updates
    document.addEventListener('cartUpdated', updateCartCounter);
    
    // Initial cart counter update
    setTimeout(updateCartCounter, 100);
    
    // Smooth scroll for anchor links
    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener('click', function (e) {
            e.preventDefault();
            const target = document.querySelector(this.getAttribute('href'));
            if (target) {
                target.scrollIntoView({
                    behavior: 'smooth',
                    block: 'start'
                });
            }
        });
    });
    
    // Add loading state for navigation links
    navLinks.forEach(link => {
        link.addEventListener('click', function(e) {
            // Don't add loading for current page or anchor links
            if (!this.classList.contains('active') && !this.href.includes('#')) {
                this.classList.add('loading');
            }
        });
    });
    
    // Accessibility improvements
    const focusableElements = mainNav.querySelectorAll('a, button, input, [tabindex]:not([tabindex="-1"])');
    
    if (mobileToggle && focusableElements.length > 0) {
        mobileToggle.addEventListener('click', function() {
            if (mainNav.classList.contains('nav-open')) {
                // Focus first focusable element when menu opens
                setTimeout(() => {
                    focusableElements[0].focus();
                }, 100);
            }
        });
        
        // Trap focus within mobile menu
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Tab' && mainNav.classList.contains('nav-open')) {
                const firstElement = focusableElements[0];
                const lastElement = focusableElements[focusableElements.length - 1];
                
                if (e.shiftKey) {
                    if (document.activeElement === firstElement) {
                        e.preventDefault();
                        lastElement.focus();
                    }
                } else {
                    if (document.activeElement === lastElement) {
                        e.preventDefault();
                        firstElement.focus();
                    }
                }
            }
        });
    }
});

// Expose cart update function globally
window.updateHeaderCartCounter = function() {
    const cartCounter = document.getElementById('cartCounter');
    if (cartCounter && window.getCartItemCount) {
        const count = window.getCartItemCount();
        cartCounter.textContent = count;
        cartCounter.style.display = count > 0 ? 'flex' : 'none';
    }
};
</script>

<!-- Scripts for enhanced functionality -->
<script>
    // Service Worker registration for PWA capabilities (optional)
    if ('serviceWorker' in navigator) {
        window.addEventListener('load', function() {
            // Uncomment when you have a service worker
            // navigator.serviceWorker.register('./sw.js');
        });
    }
    
    // Add intersection observer for animations (if needed)
    if ('IntersectionObserver' in window) {
        const observerOptions = {
            threshold: 0.1,
            rootMargin: '0px 0px -50px 0px'
        };
        
        const observer = new IntersectionObserver(function(entries) {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    entry.target.classList.add('animate-in');
                }
            });
        }, observerOptions);
        
        // Observe elements with animation class
        document.addEventListener('DOMContentLoaded', function() {
            const animateElements = document.querySelectorAll('.animate-on-scroll');
            animateElements.forEach(el => observer.observe(el));
        });
    }
</script>

</body>
</html>